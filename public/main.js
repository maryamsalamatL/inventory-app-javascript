(()=>{"use strict";function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var e=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var r,n;return r=e,n=[{key:"getAllCategories",value:function(){return(JSON.parse(localStorage.getItem("categories"))||[]).sort((function(t,e){return new Date(e.createdAt)-new Date(t.createdAt)}))}},{key:"saveCategory",value:function(t){var r=e.getAllCategories(),n=r.find((function(e){return e.id==t.id}));n?(n.title=t.title,n.description=t.description,n.createdAt=(new Date).toISOString()):(t.id=Math.random(),t.createdAt=(new Date).toDateString(),r.push(t)),localStorage.setItem("categories",JSON.stringify(r))}},{key:"getAllProducts",value:function(){return(JSON.parse(localStorage.getItem("products"))||[]).sort((function(t,e){return new Date(e.createdAt)-new Date(t.createdAt)}))}},{key:"saveProduct",value:function(t){var r=e.getAllProducts(),n=r.find((function(e){return e.id==t.id}));n?(n.title=t.title,n.quantity=t.quantity,n.category=t.category,n.createdAt=(new Date).toISOString()):(t.id=Math.random(),t.createdAt=(new Date).toISOString(),r.push(t)),localStorage.setItem("products",JSON.stringify(r))}},{key:"deleteProduct",value:function(t){var r=e.getAllProducts().filter((function(e){return e.id!=t}));localStorage.setItem("products",JSON.stringify(r))}}],null&&t(r.prototype,null),n&&t(r,n),Object.defineProperty(r,"prototype",{writable:!1}),e}();function r(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var n=document.querySelector("#category-title"),o=document.querySelector("#category-description"),a=document.querySelector(".add-category-btn"),c=document.querySelector(".cancel-btn"),i=document.querySelector("#product-category"),u=document.querySelector(".toggle-form"),d=document.querySelector(".category-form");const l=new(function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),a.addEventListener("click",(function(t){return e.addNewCategory(t)})),u.addEventListener("click",(function(){return e.toggleCategoryForm()})),c.addEventListener("click",(function(){return e.cancelCreateCategory()})),this.categories=[]}var l,s;return l=t,(s=[{key:"addNewCategory",value:function(t){t.preventDefault();var r=n.value,a=o.value;r&&a&&(e.saveCategory({title:r,description:a}),this.setApp(),this.createCategoryList(),n.value="",o.value="",u.classList.remove("hidden"),d.classList.add("hidden"))}},{key:"setApp",value:function(){this.categories=e.getAllCategories()}},{key:"createCategoryList",value:function(){var t='<option value="0" selected>یک گروه انتخاب کنید</option>';this.categories.forEach((function(e){t+='<option value="'.concat(e.id,'">').concat(e.title,"</option>")})),i.innerHTML=t}},{key:"toggleCategoryForm",value:function(){u.classList.add("hidden"),d.classList.remove("hidden")}},{key:"cancelCreateCategory",value:function(){u.classList.remove("hidden"),d.classList.add("hidden")}}])&&r(l.prototype,s),Object.defineProperty(l,"prototype",{writable:!1}),t}());function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var v=document.querySelector("#product-title"),f=document.querySelector("#product-quantity"),y=document.querySelector("#product-category"),p=document.querySelector(".add-product-btn"),g=document.querySelector(".product-list"),h=document.querySelector("#search-product"),m=document.querySelector("#sort-product"),S=document.querySelector(".modal-container"),L=document.querySelector("#modal-product-title"),P=document.querySelector("#modal-product-quantity"),b=document.querySelector("#modal-product-category"),A=document.querySelector(".add-edited-product "),q=document.querySelector(".modal-form");const k=new(function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),p.addEventListener("click",(function(t){return e.addNewProduct(t)})),h.addEventListener("input",(function(t){return e.searchProducts(t)})),m.addEventListener("click",(function(t){return e.sortProducts(t)})),A.addEventListener("click",(function(t){return e.addEditedProduct(t)})),this.products=[]}var r,n;return r=t,(n=[{key:"addNewProduct",value:function(t){t.preventDefault();var r=v.value,n=f.value,o=y.value;r&&n&&o&&(e.saveProduct({title:r,quantity:n,category:o}),this.setApp(),this.createProductList(this.products),v.value="",f.value="",y.value=0)}},{key:"setApp",value:function(){this.products=e.getAllProducts()}},{key:"createProductList",value:function(t){var r=this;g.innerHTML="";var n="";t.forEach((function(t){var r=e.getAllCategories().find((function(e){return e.id==t.category}));n+='<div class="product">\n                <h3>'.concat(t.title,'</h3>\n                <div class="product-desc">\n                    <span class="product-date">').concat(new Date(t.createdAt).toLocaleDateString("fa-IR"),'</span>\n                    <span class="product-list-quantity">').concat(t.quantity,'</span>\n                    <span class="product-list-category">').concat(r.title,'</span>\n                    <button class="edit-product-btn"  data-id=').concat(t.id,'>ادیت</button>\n                    <button class="delete-product-btn" data-id=').concat(t.id,">حذف</button>\n                </div></div> ")})),g.innerHTML=n;var o=document.querySelectorAll(".delete-product-btn"),a=document.querySelectorAll(".edit-product-btn");o.forEach((function(t){t.addEventListener("click",(function(t){return r.deleteProduct(t)}))})),a.forEach((function(t){t.addEventListener("click",(function(t){return r.editProduct(t)}))}))}},{key:"searchProducts",value:function(t){var e=t.target.value.trim(),r=this.products.filter((function(t){return t.title.includes(e)}));this.createProductList(r)}},{key:"sortProducts",value:function(t){var r=t.target.value;if("newest"==r)this.createProductList(e.getAllProducts());else if("oldest"==r){var n=this.products.sort((function(t,e){return new Date(t.createdAt)-new Date(e.createdAt)}));this.createProductList(n)}}},{key:"deleteProduct",value:function(t){var r=t.target.dataset.id;e.deleteProduct(r),this.setApp(),this.createProductList(this.products)}},{key:"createModalCategoryList",value:function(){var t='<option value="0" selected>یک گروه انتخاب کنید</option>';e.getAllCategories().forEach((function(e){t+='<option value="'.concat(e.id,'">').concat(e.title,"</option>")})),b.innerHTML=t}},{key:"editProduct",value:function(t){var e=t.target.dataset.id,r=this.products.find((function(t){return t.id==e}));S.classList.add("active"),L.value=r.title,P.value=r.quantity,this.createModalCategoryList(),b.value=r.category,q.dataset.id=r.id}},{key:"addEditedProduct",value:function(t){t.preventDefault();var r=L.value,n=P.value,o=b.value,a=q.dataset.id;r&&n&&o&&(e.saveProduct({title:r,quantity:n,category:o,id:a}),this.setApp(),this.createProductList(this.products),S.classList.remove("active"))}}])&&s(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),t}());document.addEventListener("DOMContentLoaded",(function(){l.setApp(),k.setApp(),l.createCategoryList(),k.createProductList(e.getAllProducts())}))})();